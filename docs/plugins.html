<!DOCTYPE html>  <html> <head>   <title>plugins.coffee</title>   <meta http-equiv="content-type" content="text/html; charset=UTF-8">   <link rel="stylesheet" media="all" href="docco.css" /> </head> <body>   <div id="container">     <div id="background"></div>          <table cellpadding="0" cellspacing="0">       <thead>         <tr>           <th class="docs">             <h1>               plugins.coffee             </h1>           </th>           <th class="code">           </th>         </tr>       </thead>       <tbody>                               <tr id="section-1">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-1">&#182;</a>               </div>                            </td>             <td class="code">               <div class="highlight"><pre><span class="nv">$ = </span><span class="nx">jQuery</span>
<span class="nv">doc = </span><span class="nb">document</span>
<span class="nv">win = </span><span class="nb">window</span></pre></div>             </td>           </tr>                               <tr id="section-2">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-2">&#182;</a>               </div>               <p>Counter used to give each Plugin a <code>uniq</code> identifier.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">uniq = </span><span class="o">-</span><span class="mi">1</span></pre></div>             </td>           </tr>                               <tr id="section-3">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-3">&#182;</a>               </div>               <p>Namespace used for the plugins.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">Plugins = win.Plugins = </span><span class="p">{}</span></pre></div>             </td>           </tr>                               <tr id="section-4">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-4">&#182;</a>               </div>               <p>Concatinate all <code>arguments</code> to a single string.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">Plugins.cat = </span><span class="o">-&gt;</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span><span class="p">(</span><span class="nx">arguments</span><span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-5">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-5">&#182;</a>               </div>               <p>Execute a function <code>fn</code> after a delay of microseconds <code>ms</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">Plugins.delay = </span><span class="nf">(ms, fn) -&gt;</span> <span class="nx">setTimeout</span> <span class="nx">fn</span><span class="p">,</span> <span class="nx">ms</span></pre></div>             </td>           </tr>                               <tr id="section-6">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-6">&#182;</a>               </div>               <p>Log all <code>arguments</code> to the console if avaliable.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">Plugins.log = </span><span class="o">-&gt;</span> <span class="nx">win</span><span class="p">.</span><span class="nx">console</span><span class="o">?</span><span class="p">.</span><span class="nx">log</span> <span class="nx">arg</span> <span class="k">for</span> <span class="nx">arg</span> <span class="k">in</span> <span class="nb">Array</span><span class="p">.</span><span class="nx">prototype</span><span class="p">.</span><span class="nx">slice</span><span class="p">.</span><span class="nx">call</span> <span class="nx">arguments</span></pre></div>             </td>           </tr>                               <tr id="section-7">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-7">&#182;</a>               </div>               <p>Create a DOM-element of a given <code>type</code> and with a given DOM-<code>klass</code>.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">Plugins.create = </span><span class="nf">(type, klass) -&gt;</span>
  <span class="nv">el = </span><span class="nx">$</span><span class="p">(</span><span class="nx">doc</span><span class="p">.</span><span class="nx">createElement</span> <span class="nx">type</span><span class="p">)</span>
  <span class="nx">el</span><span class="p">.</span><span class="nx">addClass</span> <span class="nx">klass</span> <span class="k">if</span> <span class="nx">klass</span>
  <span class="k">return</span> <span class="nx">el</span></pre></div>             </td>           </tr>                               <tr id="section-8">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-8">&#182;</a>               </div>               <h2>Plugins.Plugin</h2>

<p>The Plugin class can be extended to create a custom plugin. A configuration
object <code>config</code> should be provided to configure the plugin and an optional
<code>invoker</code> jQuery-object can be provided to know which element invoked the 
plugin.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">Plugins</span><span class="p">.</span><span class="nx">Plugin</span>
  <span class="nv">defaults:</span>
    <span class="nv">klass: </span><span class="s">&quot;plugin&quot;</span> <span class="c1"># Class of the DOM-element</span></pre></div>             </td>           </tr>                               <tr id="section-9">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-9">&#182;</a>               </div>               <p>Construct a new Plugin, while providing  a <code>config</code> and <code>invoker</code> object.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">constructor: </span><span class="nf">(config, invoker) -&gt;</span>
    <span class="vi">@id = </span><span class="o">++</span><span class="nx">uniq</span>
    <span class="vi">@config = </span><span class="nx">$</span><span class="p">.</span><span class="nx">extend</span> <span class="p">{},</span> <span class="nx">@defaults</span><span class="p">,</span> <span class="nx">config</span>
    <span class="vi">@invoker = </span><span class="nx">invoker</span>
    <span class="vi">@elId = </span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">klass</span><span class="p">,</span> <span class="s">&quot;-&quot;</span><span class="p">,</span> <span class="nx">@id</span>
    <span class="vi">@selector = </span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="s">&quot;</span><span class="err">#</span><span class="s">&quot;</span><span class="p">,</span> <span class="nx">@elId</span>
    <span class="nx">@init</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-10">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-10">&#182;</a>               </div>               <p>Method that gets executed if the constructor is done constructing a new
Plugin.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">init: </span><span class="o">-&gt;</span> <span class="kc">false</span></pre></div>             </td>           </tr>                               <tr id="section-11">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-11">&#182;</a>               </div>               <h2>Plugins.Dialog</h2>

<p>Plugin that shows a dialog box with optional <code>onCancel</code>, <code>onConfirm</code>, 
<code>onOpen</code> and <code>onClose</code> callback functions which can be set in the 
<code>config</code>-object.</p>

<p><em>Example usage in your JavaScript:</em></p>

<pre><code>$("div").dialog({
    onCancel: function(){ alert("Canceled!"); },
    onConfirm: function(){ alert("Confirmed!"); }
});
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">Plugins</span><span class="p">.</span><span class="nx">Dialog</span> <span class="k">extends</span> <span class="nx">Plugins</span><span class="p">.</span><span class="nx">Plugin</span>
  <span class="nv">defaults:</span>
    <span class="nv">cancelText: </span><span class="s">&quot;Cancel&quot;</span>            <span class="c1"># Cancel button text</span>
    <span class="nv">confirmText: </span><span class="s">&quot;OK&quot;</span>               <span class="c1"># Confirm button text</span>
    <span class="nv">contentClass: </span><span class="s">&quot;dialog-content&quot;</span>  <span class="c1"># Content DOM class</span>
    <span class="nv">headerText: </span><span class="s">&quot;Confirm&quot;</span>           <span class="c1"># Text for the dialog header</span>
    <span class="nv">invokeEvent: </span><span class="s">&quot;click&quot;</span>            <span class="c1"># Event that invokes the plugin</span>
    <span class="nv">klass: </span><span class="s">&quot;dialog&quot;</span>                 <span class="c1"># Class of the DOM element</span>
    <span class="nv">onCancel: </span><span class="o">-&gt;</span> <span class="k">return</span>             <span class="c1"># Callback on cancel</span>
    <span class="nv">onClose: </span><span class="o">-&gt;</span> <span class="k">return</span>              <span class="c1"># Callback on close</span>
    <span class="nv">onConfirm: </span><span class="o">-&gt;</span> <span class="k">return</span>            <span class="c1"># Callback on confirm</span>
    <span class="nv">onOpen: </span><span class="o">-&gt;</span> <span class="k">return</span>               <span class="c1"># Callback on open</span>
    <span class="nv">showClose: </span><span class="kc">true</span>                 <span class="c1"># Show close button on top of dialog</span></pre></div>             </td>           </tr>                               <tr id="section-12">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-12">&#182;</a>               </div>               <p>Bind click/keyup events to the buttons of the dialog.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">bind: </span><span class="o">-&gt;</span>
    <span class="nv">at = </span><span class="nx">@</span>
    <span class="nx">$</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">at</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="s">&quot; .cancel&quot;</span><span class="p">).</span><span class="kc">on</span><span class="p">(</span><span class="s">&quot;click&quot;</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="nx">at</span><span class="p">.</span><span class="nx">cancel</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">at</span><span class="p">)</span>
    <span class="nx">$</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">at</span><span class="p">.</span><span class="nx">selector</span><span class="p">,</span> <span class="s">&quot; .confirm&quot;</span><span class="p">).</span><span class="kc">on</span><span class="p">(</span><span class="s">&quot;click&quot;</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="nx">at</span><span class="p">.</span><span class="nx">confirm</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">at</span><span class="p">)</span>
    <span class="nx">$</span><span class="p">(</span><span class="nx">doc</span><span class="p">).</span><span class="nx">keyup</span> <span class="nf">(e) -&gt;</span>
      <span class="k">if</span> <span class="nx">$</span><span class="p">(</span><span class="nx">at</span><span class="p">.</span><span class="nx">selector</span><span class="p">).</span><span class="o">is</span><span class="p">(</span><span class="s">&quot;:visible&quot;</span><span class="p">)</span>
        <span class="nx">at</span><span class="p">.</span><span class="nx">confirm</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">at</span> <span class="k">if</span> <span class="nx">e</span><span class="p">.</span><span class="nx">keyCode</span> <span class="o">is</span> <span class="mi">13</span>
        <span class="nx">at</span><span class="p">.</span><span class="nx">cancel</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">at</span> <span class="k">if</span> <span class="nx">e</span><span class="p">.</span><span class="nx">keyCode</span> <span class="o">is</span> <span class="mi">27</span>
    <span class="nx">$</span><span class="p">(</span><span class="nx">win</span><span class="p">).</span><span class="kc">on</span> <span class="s">&quot;resize scroll&quot;</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="nx">at</span><span class="p">.</span><span class="nx">position</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">at</span>
    <span class="nx">@invoker</span><span class="p">.</span><span class="kc">on</span> <span class="nx">at</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">invokeEvent</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="nx">at</span><span class="p">.</span><span class="nx">open</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">at</span></pre></div>             </td>           </tr>                               <tr id="section-13">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-13">&#182;</a>               </div>               <p>Build new dialog DOM-element and append it to the HTML body.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">build: </span><span class="o">-&gt;</span>
    <span class="nv">content = </span><span class="nx">@invoker</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="s">&quot;.&quot;</span><span class="p">,</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">contentClass</span><span class="p">).</span><span class="nx">html</span><span class="p">()</span>
    <span class="nx">@invoker</span><span class="p">.</span><span class="nx">next</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="s">&quot;.&quot;</span><span class="p">,</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">contentClass</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span>
    <span class="nx">Plugins</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s">&quot;div&quot;</span><span class="p">,</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">klass</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="nx">@elId</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="s">&quot;body&quot;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span>
    <span class="nx">Plugins</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s">&quot;div&quot;</span><span class="p">,</span> <span class="s">&quot;overlay&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">@selector</span><span class="p">)</span>
    <span class="nx">Plugins</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s">&quot;div&quot;</span><span class="p">,</span> <span class="s">&quot;window&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">@selector</span><span class="p">)</span>
    <span class="nx">Plugins</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s">&quot;div&quot;</span><span class="p">,</span> <span class="s">&quot;header&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">@selector</span><span class="p">,</span> <span class="s">&quot; .window&quot;</span><span class="p">)</span>
    <span class="nx">Plugins</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s">&quot;h3&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">@config</span><span class="p">.</span><span class="nx">headerText</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">@selector</span><span class="p">,</span> <span class="s">&quot; .header&quot;</span><span class="p">)</span>
    <span class="nx">Plugins</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s">&quot;button&quot;</span><span class="p">,</span> <span class="s">&quot;cancel&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="s">&quot;×&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">@selector</span><span class="p">,</span> <span class="s">&quot; .header&quot;</span><span class="p">)</span> <span class="k">if</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">showClose</span>
    <span class="nx">Plugins</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s">&quot;div&quot;</span><span class="p">,</span> <span class="s">&quot;clear&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">@selector</span><span class="p">,</span> <span class="s">&quot; .header&quot;</span><span class="p">)</span>
    <span class="nx">Plugins</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s">&quot;div&quot;</span><span class="p">,</span> <span class="s">&quot;content&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">content</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">@selector</span><span class="p">,</span> <span class="s">&quot; .window&quot;</span><span class="p">)</span>
    <span class="nx">Plugins</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s">&quot;div&quot;</span><span class="p">,</span> <span class="s">&quot;actions&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">@selector</span><span class="p">,</span> <span class="s">&quot; .window&quot;</span><span class="p">)</span>
    <span class="nx">Plugins</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s">&quot;button&quot;</span><span class="p">,</span> <span class="s">&quot;cancel&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">@config</span><span class="p">.</span><span class="nx">cancelText</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">@selector</span><span class="p">,</span> <span class="s">&quot; .actions&quot;</span><span class="p">)</span>
    <span class="nx">Plugins</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s">&quot;button&quot;</span><span class="p">,</span> <span class="s">&quot;confirm&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">@config</span><span class="p">.</span><span class="nx">confirmText</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">@selector</span><span class="p">,</span> <span class="s">&quot; .actions&quot;</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-14">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-14">&#182;</a>               </div>               <p>Close the dialog window and call the <code>onCancel</code> configuration callback when 
done.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">cancel: </span><span class="o">-&gt;</span>
    <span class="nx">@config</span><span class="p">.</span><span class="nx">onCancel</span><span class="o">?</span><span class="p">()</span>
    <span class="nx">@close</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-15">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-15">&#182;</a>               </div>               <p>Close the dialog window and call the <code>onClose</code> configuration callback when 
done.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">close: </span><span class="o">-&gt;</span>
    <span class="nx">@config</span><span class="p">.</span><span class="nx">onClose</span><span class="o">?</span><span class="p">()</span>
    <span class="nx">$</span><span class="p">(</span><span class="nx">@selector</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-16">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-16">&#182;</a>               </div>               <p>Close the dialog window and call the <code>onConfirm</code> configuration callback when 
done.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">confirm: </span><span class="o">-&gt;</span>
    <span class="nx">@config</span><span class="p">.</span><span class="nx">onConfirm</span><span class="o">?</span><span class="p">()</span>
    <span class="nx">@close</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-17">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-17">&#182;</a>               </div>               <p>Initialize the newly created Dialog plugin.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">init: </span><span class="o">-&gt;</span>
    <span class="nx">@build</span><span class="p">()</span>
    <span class="nx">@bind</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-18">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-18">&#182;</a>               </div>               <p>Close the dialog window and call the <code>onOpen</code> configuration callback when 
done.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">open: </span><span class="o">-&gt;</span>
    <span class="nx">$</span><span class="p">(</span><span class="nx">@selector</span><span class="p">).</span><span class="nx">show</span><span class="p">()</span>
    <span class="nx">@position</span><span class="p">()</span>
    <span class="nx">@config</span><span class="p">.</span><span class="nx">onOpen</span><span class="o">?</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-19">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-19">&#182;</a>               </div>               <p>Position the dialog on the screen.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">position: </span><span class="o">-&gt;</span>
    <span class="nv">ww = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">win</span><span class="p">).</span><span class="nx">outerWidth</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nv">wh = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">win</span><span class="p">).</span><span class="nx">outerHeight</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nv">iw = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">@selector</span><span class="p">,</span> <span class="s">&quot; .window&quot;</span><span class="p">).</span><span class="nx">outerWidth</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nv">ih = </span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">@selector</span><span class="p">,</span> <span class="s">&quot; .window&quot;</span><span class="p">).</span><span class="nx">outerHeight</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nx">$</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">@selector</span><span class="p">,</span> <span class="s">&quot; .overlay&quot;</span><span class="p">).</span><span class="nx">css</span>
      <span class="nv">height: </span><span class="nx">$</span><span class="p">(</span><span class="nx">doc</span><span class="p">).</span><span class="nx">outerHeight</span><span class="p">()</span>
      <span class="nv">left: </span><span class="nx">$</span><span class="p">(</span><span class="nx">win</span><span class="p">).</span><span class="nx">scrollLeft</span><span class="p">()</span>
    <span class="nx">$</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">@selector</span><span class="p">,</span> <span class="s">&quot; .window&quot;</span><span class="p">).</span><span class="nx">css</span>
      <span class="nv">left: </span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">ww</span> <span class="o">-</span> <span class="nx">iw</span> <span class="o">+</span> <span class="nx">$</span><span class="p">(</span><span class="nx">win</span><span class="p">).</span><span class="nx">scrollLeft</span><span class="p">(),</span> <span class="s">&quot;px&quot;</span>
      <span class="nv">top: </span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="nx">wh</span> <span class="o">-</span> <span class="nx">ih</span> <span class="o">+</span> <span class="nx">$</span><span class="p">(</span><span class="nx">win</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">(),</span> <span class="s">&quot;px&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-20">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-20">&#182;</a>               </div>               <p>Define the plugin as a jQuery-function.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">$.fn.dialog = </span><span class="nf">(config) -&gt;</span> <span class="nx">@</span><span class="p">.</span><span class="nx">each</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nx">Plugins</span><span class="p">.</span><span class="nx">Dialog</span> <span class="nx">config</span><span class="p">,</span> <span class="nx">$</span><span class="p">(</span><span class="nx">@</span><span class="p">)</span></pre></div>             </td>           </tr>                               <tr id="section-21">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-21">&#182;</a>               </div>               <h2>Plugins.Tooltip</h2>

<p>Plugin that shows a tooltip when the user invokes a configurable event on
the <code>invoker</code>.</p>

<p><em>Example usage in your JavaScript:</em></p>

<pre><code>$("div").tooltip();
</code></pre>             </td>             <td class="code">               <div class="highlight"><pre><span class="k">class</span> <span class="nx">Plugins</span><span class="p">.</span><span class="nx">Tooltip</span> <span class="k">extends</span> <span class="nx">Plugins</span><span class="p">.</span><span class="nx">Plugin</span>
  <span class="nv">defaults:</span>
    <span class="nv">attr: </span><span class="s">&quot;title&quot;</span>                  <span class="c1"># DOM-attribute that containts content</span>
    <span class="nv">delay: </span><span class="mi">100</span>                     <span class="c1"># Delay in showing the tooltip</span>
    <span class="nv">fade: </span> <span class="mi">100</span>                     <span class="c1"># Fade time in microseconds</span>
    <span class="nv">invokeHideEvent: </span><span class="s">&quot;mouseleave&quot;</span>  <span class="c1"># Event that hides the Tooltip</span>
    <span class="nv">invokeShowEvent: </span><span class="s">&quot;mouseenter&quot;</span>  <span class="c1"># Event that shows the Tooltip</span>
    <span class="nv">klass: </span><span class="s">&quot;tooltip&quot;</span>               <span class="c1"># Class of the DOM-element</span>
    <span class="nv">margin: </span><span class="mi">3</span>                      <span class="c1"># Margin between Tooltip and invoker</span>
    <span class="nv">position: </span><span class="s">&quot;top&quot;</span>                <span class="c1"># Position of Tooltip relative to invoker</span>
  <span class="nv">timer: </span><span class="kc">false</span></pre></div>             </td>           </tr>                               <tr id="section-22">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-22">&#182;</a>               </div>               <p>Reposition the tooltip when the element is to close to the border of the window.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">_reposition: </span><span class="nf">(xy, position) -&gt;</span>
    <span class="k">switch</span> <span class="nx">position</span>
      <span class="k">when</span> <span class="s">&quot;right&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">xy</span><span class="p">.</span><span class="nx">left</span> <span class="o">-</span> <span class="nx">$</span><span class="p">(</span><span class="nx">win</span><span class="p">).</span><span class="nx">scrollLeft</span><span class="p">()</span> <span class="o">+</span> <span class="nx">@invoker</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">()</span> <span class="o">+</span> <span class="nx">$</span><span class="p">(</span><span class="nx">@selector</span><span class="p">).</span><span class="nx">outerWidth</span><span class="p">()</span> <span class="o">+</span> <span class="mi">15</span> <span class="o">&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="nx">win</span><span class="p">).</span><span class="nx">width</span><span class="p">())</span> <span class="k">then</span> <span class="s">&quot;left&quot;</span> <span class="k">else</span> <span class="nx">position</span>
      <span class="k">when</span> <span class="s">&quot;bottom&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">xy</span><span class="p">.</span><span class="nx">top</span> <span class="o">-</span> <span class="nx">$</span><span class="p">(</span><span class="nx">win</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">()</span> <span class="o">+</span> <span class="nx">@invoker</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">()</span> <span class="o">+</span> <span class="nx">$</span><span class="p">(</span><span class="nx">@selector</span><span class="p">).</span><span class="nx">outerHeight</span><span class="p">()</span> <span class="o">+</span> <span class="mi">15</span> <span class="o">&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="nx">win</span><span class="p">).</span><span class="nx">height</span><span class="p">())</span> <span class="k">then</span> <span class="s">&quot;top&quot;</span> <span class="k">else</span> <span class="nx">position</span>
      <span class="k">when</span> <span class="s">&quot;left&quot;</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">xy</span><span class="p">.</span><span class="nx">left</span> <span class="o">-</span> <span class="nx">$</span><span class="p">(</span><span class="nx">win</span><span class="p">).</span><span class="nx">scrollLeft</span><span class="p">()</span> <span class="o">&lt;</span> <span class="nx">$</span><span class="p">(</span><span class="nx">@selector</span><span class="p">).</span><span class="nx">outerWidth</span><span class="p">()</span> <span class="o">+</span> <span class="mi">15</span><span class="p">)</span> <span class="k">then</span> <span class="s">&quot;right&quot;</span> <span class="k">else</span> <span class="nx">position</span>
      <span class="k">else</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">xy</span><span class="p">.</span><span class="nx">top</span> <span class="o">-</span> <span class="nx">$</span><span class="p">(</span><span class="nx">win</span><span class="p">).</span><span class="nx">scrollTop</span><span class="p">()</span> <span class="o">&lt;</span> <span class="nx">$</span><span class="p">(</span><span class="nx">@selector</span><span class="p">).</span><span class="nx">outerHeight</span><span class="p">()</span> <span class="o">+</span> <span class="mi">15</span><span class="p">)</span> <span class="k">then</span> <span class="s">&quot;bottom&quot;</span> <span class="k">else</span> <span class="nx">position</span></pre></div>             </td>           </tr>                               <tr id="section-23">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-23">&#182;</a>               </div>               <p>Bind events to show, hide or reposition the tooltip.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">bind: </span><span class="o">-&gt;</span>
    <span class="nv">at = </span><span class="nx">@</span>
    <span class="nx">@invoker</span><span class="p">.</span><span class="kc">on</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">invokeShowEvent</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="nx">at</span><span class="p">.</span><span class="nx">show</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">at</span> <span class="k">if</span> <span class="o">not</span> <span class="nx">$</span><span class="p">(</span><span class="nx">at</span><span class="p">.</span><span class="nx">selector</span><span class="p">).</span><span class="o">is</span><span class="p">(</span><span class="s">&quot;:visible&quot;</span><span class="p">)</span>
    <span class="nx">@invoker</span><span class="p">.</span><span class="kc">on</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">invokeHideEvent</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="nx">at</span><span class="p">.</span><span class="nx">hide</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">at</span> <span class="k">if</span> <span class="nx">$</span><span class="p">(</span><span class="nx">at</span><span class="p">.</span><span class="nx">selector</span><span class="p">).</span><span class="o">is</span><span class="p">(</span><span class="s">&quot;:visible&quot;</span><span class="p">)</span>
    <span class="nx">$</span><span class="p">(</span><span class="nx">win</span><span class="p">).</span><span class="kc">on</span> <span class="s">&quot;scroll&quot;</span><span class="p">,</span> <span class="nx">@position</span><span class="p">.</span><span class="nx">apply</span> <span class="nx">@</span></pre></div>             </td>           </tr>                               <tr id="section-24">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-24">&#182;</a>               </div>               <p>Build new dialog DOM-element and append it to the HTML body.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">build: </span><span class="o">-&gt;</span>
    <span class="nx">Plugins</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s">&quot;div&quot;</span><span class="p">,</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">klass</span><span class="p">).</span><span class="nx">attr</span><span class="p">(</span><span class="s">&quot;id&quot;</span><span class="p">,</span> <span class="nx">@elId</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="s">&quot;body&quot;</span><span class="p">).</span><span class="nx">hide</span><span class="p">()</span>
    <span class="nx">Plugins</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s">&quot;div&quot;</span><span class="p">,</span> <span class="s">&quot;arrow&quot;</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">@selector</span><span class="p">)</span>
    <span class="nx">Plugins</span><span class="p">.</span><span class="nx">create</span><span class="p">(</span><span class="s">&quot;div&quot;</span><span class="p">,</span> <span class="s">&quot;content&quot;</span><span class="p">).</span><span class="nx">html</span><span class="p">(</span><span class="nx">@invoker</span><span class="p">.</span><span class="nx">attr</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">attr</span><span class="p">).</span><span class="nx">appendTo</span><span class="p">(</span><span class="nx">@selector</span><span class="p">)</span>
    <span class="nx">@invoker</span><span class="p">.</span><span class="nx">attr</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">attr</span><span class="p">,</span> <span class="s">&quot;&quot;</span></pre></div>             </td>           </tr>                               <tr id="section-25">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-25">&#182;</a>               </div>               <p>Hide the tooltip using the <code>config</code>-ured <code>delay</code> and <code>fade</code> microseconds.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">hide: </span><span class="o">-&gt;</span>
    <span class="nv">at = </span><span class="nx">@</span>
    <span class="nx">clearTimeout</span> <span class="nx">@timer</span>
    <span class="vi">@timer = </span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">delay</span> <span class="nx">at</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">delay</span><span class="p">,</span> <span class="o">-&gt;</span> <span class="nx">$</span><span class="p">(</span><span class="nx">at</span><span class="p">.</span><span class="nx">selector</span><span class="p">).</span><span class="nx">fadeOut</span> <span class="nx">at</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">fade</span></pre></div>             </td>           </tr>                               <tr id="section-26">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-26">&#182;</a>               </div>               <p>Initialize the newly created Tooltip plugin.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">init: </span><span class="o">-&gt;</span>
    <span class="nx">@build</span><span class="p">()</span>
    <span class="nx">@bind</span><span class="p">()</span></pre></div>             </td>           </tr>                               <tr id="section-27">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-27">&#182;</a>               </div>               <p>Position the element within the window. Reposition the tooltip when to close
to the border of the window.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">position: </span><span class="o">-&gt;</span>
    <span class="nv">xy = </span><span class="nx">@invoker</span><span class="p">.</span><span class="nx">position</span><span class="p">()</span>
    <span class="nv">position = </span><span class="nx">@_reposition</span> <span class="nx">xy</span><span class="p">,</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">position</span>
    <span class="k">switch</span> <span class="nx">position</span>
      <span class="k">when</span> <span class="s">&quot;right&quot;</span>
        <span class="nv">top = </span><span class="nx">xy</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="p">(</span><span class="nx">@invoker</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">@selector</span><span class="p">).</span><span class="nx">outerHeight</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="nv">left = </span><span class="nx">xy</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="nx">@invoker</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">margin</span><span class="p">)</span>
      <span class="k">when</span> <span class="s">&quot;bottom&quot;</span>
        <span class="nv">top = </span><span class="nx">xy</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="nx">@invoker</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">()</span> <span class="o">+</span> <span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">margin</span><span class="p">)</span>
        <span class="nv">left = </span><span class="nx">xy</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="p">(</span><span class="nx">@invoker</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">@selector</span><span class="p">).</span><span class="nx">outerWidth</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
      <span class="k">when</span> <span class="s">&quot;left&quot;</span>
        <span class="nv">top = </span><span class="nx">xy</span><span class="p">.</span><span class="nx">top</span> <span class="o">+</span> <span class="p">(</span><span class="nx">@invoker</span><span class="p">.</span><span class="nx">outerHeight</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">@selector</span><span class="p">).</span><span class="nx">outerHeight</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="nv">left = </span><span class="nx">xy</span><span class="p">.</span><span class="nx">left</span> <span class="o">-</span> <span class="nx">$</span><span class="p">(</span><span class="nx">@selector</span><span class="p">).</span><span class="nx">outerWidth</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">margin</span><span class="p">)</span>
      <span class="k">else</span>
        <span class="nv">top = </span><span class="nx">xy</span><span class="p">.</span><span class="nx">top</span> <span class="o">-</span> <span class="nx">$</span><span class="p">(</span><span class="nx">@selector</span><span class="p">).</span><span class="nx">outerHeight</span><span class="p">()</span> <span class="o">-</span> <span class="p">(</span><span class="mi">5</span> <span class="o">+</span> <span class="nx">@config</span><span class="p">.</span><span class="nx">margin</span><span class="p">)</span>
        <span class="nv">left = </span><span class="nx">xy</span><span class="p">.</span><span class="nx">left</span> <span class="o">+</span> <span class="p">(</span><span class="nx">@invoker</span><span class="p">.</span><span class="nx">outerWidth</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="nx">$</span><span class="p">(</span><span class="nx">@selector</span><span class="p">).</span><span class="nx">outerWidth</span><span class="p">()</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="nx">$</span><span class="p">(</span><span class="nx">@selector</span><span class="p">).</span><span class="nx">removeClass</span><span class="p">(</span><span class="s">&quot;top right bottom left&quot;</span><span class="p">).</span><span class="nx">addClass</span><span class="p">(</span><span class="nx">position</span><span class="p">).</span><span class="nx">css</span>
      <span class="nv">left: </span><span class="nx">left</span>
      <span class="nv">top: </span><span class="nx">top</span></pre></div>             </td>           </tr>                               <tr id="section-28">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-28">&#182;</a>               </div>               <p>Show the tooltip using the <code>config</code>-ured <code>delay</code> and <code>fade</code> microseconds.</p>             </td>             <td class="code">               <div class="highlight"><pre>  <span class="nv">show: </span><span class="o">-&gt;</span>
    <span class="nv">at = </span><span class="nx">@</span>
    <span class="nx">@position</span><span class="p">()</span>
    <span class="vi">@timer = </span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">delay</span> <span class="nx">at</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">delay</span><span class="p">,</span> <span class="o">-&gt;</span> 
      <span class="nx">$</span><span class="p">(</span><span class="nx">Plugins</span><span class="p">.</span><span class="nx">cat</span> <span class="s">&quot;.&quot;</span><span class="p">,</span> <span class="nx">at</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">klass</span><span class="p">).</span><span class="nx">fadeOut</span> <span class="nx">at</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">fade</span>
      <span class="nx">$</span><span class="p">(</span><span class="nx">at</span><span class="p">.</span><span class="nx">selector</span><span class="p">).</span><span class="nx">fadeIn</span> <span class="nx">at</span><span class="p">.</span><span class="nx">config</span><span class="p">.</span><span class="nx">fade</span></pre></div>             </td>           </tr>                               <tr id="section-29">             <td class="docs">               <div class="pilwrap">                 <a class="pilcrow" href="#section-29">&#182;</a>               </div>               <p>Define the plugin as a jQuery-function.</p>             </td>             <td class="code">               <div class="highlight"><pre><span class="nv">$.fn.tooltip = </span><span class="nf">(config) -&gt;</span> <span class="nx">@</span><span class="p">.</span><span class="nx">each</span> <span class="o">-&gt;</span> <span class="k">new</span> <span class="nx">Plugins</span><span class="p">.</span><span class="nx">Tooltip</span> <span class="nx">config</span><span class="p">,</span> <span class="nx">$</span><span class="p">(</span><span class="nx">@</span><span class="p">)</span>

</pre></div>             </td>           </tr>                </tbody>     </table>   </div> </body> </html> 